{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "JASK - Get Signal Details",
    "aliasName": null,
    "tag": "#JASK, #Signal",
    "description": "Gets JASK Signal details",
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "signal",
        "alert_iri"
    ],
    "synchronous": false,
    "lastModifyDate": 1646219489,
    "collection": "\/api\/3\/workflow_collections\/817daef5-8d0e-4c2e-8cd7-7d5d8da9ceb4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/ee0cc6ae-d104-40a2-ba30-479950e46d9f",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Pull Indicators from Signal Details",
            "description": null,
            "arguments": {
                "append_dst_ip": "{{ vars.indicators.append({\"name\": \"Destination IP\", \"value\": vars.full_record.dst_ip.address}) if \"dst_ip\" in vars.full_record }}",
                "append_src_ip": "{{ vars.indicators.append({\"name\": \"Source IP\", \"value\": vars.full_record.src_ip.address}) if \"src_ip\" in vars.full_record }}",
                "append_filehash": "{{ vars.indicators.append({\"name\": \"SHA256\", \"value\": vars.full_record.hash.sha256}) if (\"hash\" in vars.full_record and \"sha256\" in vars.full_record.hash) else indicators.append({\"name\": \"MD5\", \"value\": vars.full_record.hash.md5}) if (\"hash\" in vars.full_record and \"md5\" in vars.full_record.hash) }}",
                "append_src_nat_ip": "{{ vars.indicators.append({\"name\": \"Source NAT IP\", \"value\": vars.full_record.src_nat_ip.address}) if \"src_nat_ip\" in vars.full_record }}",
                "threat_indicators": "{{ (vars.steps.Get_Details.data.threat_indicators| toDict) if \"threat_indicators\" in vars.steps.Get_Details.data }}",
                "append_endpoint_ip": "{{ vars.indicators.append({\"name\": \"Endpoint IP\", \"value\": vars.full_record.endpoint_ip.address}) if \"endpoint_ip\" in vars.full_record }}"
            },
            "status": null,
            "top": "30",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "95d414b3-b9c5-4b92-8c40-393139eb72dd"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Threat Indicators to list",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{ vars.threat_indicators }}",
                    "condition": ""
                },
                "append_threat_indicator": "{{ vars.indicators.append({\"name\": vars.item.indicator_type, \"value\": vars.item.value}) }}"
            },
            "status": null,
            "top": "30",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "e8f303e0-8770-4738-8b04-87f3c4485dea"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add or Find Indicator Records",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.indicators}}",
                    "condition": ""
                },
                "arguments": {
                    "alert_iri": "",
                    "indicator": "{{ vars.item }}",
                    "signal_id": "{{vars.steps.Get_Details.data.id}}",
                    "signal_name": "{{vars.steps.Get_Details.data.name}}",
                    "signal_description": "{{vars.steps.Get_Details.data.description}}"
                },
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/8d274bbe-0b78-4d0b-be0d-644a766566fa"
            },
            "status": null,
            "top": "30",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "283530ba-402b-4b18-899c-167b2c30cf68"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Details",
            "description": null,
            "arguments": {
                "name": "JASK ASOC",
                "config": "d12afb7a-4904-4375-b03c-efa283286a51",
                "params": {
                    "signalId": "{{ vars.input.params.signal.id }}"
                },
                "version": "1.0.0",
                "connector": "jask-asoc",
                "operation": "get_signal_details",
                "operationTitle": "Get Signal Details",
                "step_variables": {
                    "full_record": "{{ vars.result.data['full_records'][0] }}"
                }
            },
            "status": null,
            "top": "30",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "5307e23c-7fd5-496e-b141-57b5e7ef2d96"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": {
                            "signal": "{{ vars.signal }}",
                            "alert_iri": "{{ vars.alert_iri }}"
                        }
                    },
                    "indicators": "[]"
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "ee0cc6ae-d104-40a2-ba30-479950e46d9f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Output Indicator IRIs",
            "description": null,
            "arguments": {
                "indicator_iris": "{{ vars.steps.Add_or_Find_Indicator_Records | json_query('[].indicator_iri') }}"
            },
            "status": null,
            "top": "30",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "87b4dc4e-b017-4968-a8a2-be1811ce03e0"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get details -> Pull Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/95d414b3-b9c5-4b92-8c40-393139eb72dd",
            "sourceStep": "\/api\/3\/workflow_steps\/5307e23c-7fd5-496e-b141-57b5e7ef2d96",
            "label": null,
            "isExecuted": false,
            "uuid": "1bd9b225-a89e-48d4-92cf-5de94abaa5f6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get details",
            "targetStep": "\/api\/3\/workflow_steps\/5307e23c-7fd5-496e-b141-57b5e7ef2d96",
            "sourceStep": "\/api\/3\/workflow_steps\/ee0cc6ae-d104-40a2-ba30-479950e46d9f",
            "label": null,
            "isExecuted": false,
            "uuid": "eaed4bca-786d-47ed-bb3b-921b23d39c4d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Threat Indicators to list -> Add or Find Indicator Records",
            "targetStep": "\/api\/3\/workflow_steps\/283530ba-402b-4b18-899c-167b2c30cf68",
            "sourceStep": "\/api\/3\/workflow_steps\/e8f303e0-8770-4738-8b04-87f3c4485dea",
            "label": null,
            "isExecuted": false,
            "uuid": "d779a97c-0e72-4895-80d5-541d2df58b17"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add or Find Indicator Records -> Output Indicator IRIs",
            "targetStep": "\/api\/3\/workflow_steps\/87b4dc4e-b017-4968-a8a2-be1811ce03e0",
            "sourceStep": "\/api\/3\/workflow_steps\/283530ba-402b-4b18-899c-167b2c30cf68",
            "label": null,
            "isExecuted": false,
            "uuid": "a8e355e8-998a-412e-aba2-818a5efd0340"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Pull Indicators from Signal Details -> Add Threat Indicators to list",
            "targetStep": "\/api\/3\/workflow_steps\/e8f303e0-8770-4738-8b04-87f3c4485dea",
            "sourceStep": "\/api\/3\/workflow_steps\/95d414b3-b9c5-4b92-8c40-393139eb72dd",
            "label": null,
            "isExecuted": false,
            "uuid": "e242198c-92a4-4ef1-b6d2-2469f516a730"
        }
    ],
    "priority": null,
    "uuid": "92b328fd-8e7c-4fb1-a608-f47fec2f0c38",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Subroutine",
        "FSRSolutionPack",
        "vulnerabilityManagement-1.0.1",
        "JASK",
        "JASK - Create Alert for Insight"
    ]
}