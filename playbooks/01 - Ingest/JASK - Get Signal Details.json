{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "JASK - Get Signal Details",
    "aliasName": null,
    "tag": "#JASK, #Signal",
    "description": "Gets JASK Signal details",
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "signal",
        "alert_iri"
    ],
    "synchronous": false,
    "lastModifyDate": 1638455617,
    "collection": "\/api\/3\/workflow_collections\/f6e0b44a-74d8-4c28-9d4f-f2ed70fba27d",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/980abe3f-5331-48a6-b691-16bfe6cd1451",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Pull Indicators from Signal Details",
            "description": null,
            "arguments": {
                "append_dst_ip": "{{ vars.indicators.append({\"name\": \"Destination IP\", \"value\": vars.full_record.dst_ip.address}) if \"dst_ip\" in vars.full_record }}",
                "append_src_ip": "{{ vars.indicators.append({\"name\": \"Source IP\", \"value\": vars.full_record.src_ip.address}) if \"src_ip\" in vars.full_record }}",
                "append_filehash": "{{ vars.indicators.append({\"name\": \"SHA256\", \"value\": vars.full_record.hash.sha256}) if (\"hash\" in vars.full_record and \"sha256\" in vars.full_record.hash) else indicators.append({\"name\": \"MD5\", \"value\": vars.full_record.hash.md5}) if (\"hash\" in vars.full_record and \"md5\" in vars.full_record.hash) }}",
                "append_src_nat_ip": "{{ vars.indicators.append({\"name\": \"Source NAT IP\", \"value\": vars.full_record.src_nat_ip.address}) if \"src_nat_ip\" in vars.full_record }}",
                "threat_indicators": "{{ (vars.steps.Get_Details.data.threat_indicators| toDict) if \"threat_indicators\" in vars.steps.Get_Details.data }}",
                "append_endpoint_ip": "{{ vars.indicators.append({\"name\": \"Endpoint IP\", \"value\": vars.full_record.endpoint_ip.address}) if \"endpoint_ip\" in vars.full_record }}"
            },
            "status": null,
            "top": "30",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "56fb8c0f-8f3b-4505-807a-b48580841b88",
            "id": 293
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Threat Indicators to list",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{ vars.threat_indicators }}",
                    "condition": ""
                },
                "append_threat_indicator": "{{ vars.indicators.append({\"name\": vars.item.indicator_type, \"value\": vars.item.value}) }}"
            },
            "status": null,
            "top": "30",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "945f02cb-667d-4892-a746-1bbf57009e16",
            "id": 294
        },
        {
            "@type": "WorkflowStep",
            "name": "Add or Find Indicator Records",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.indicators}}",
                    "condition": ""
                },
                "arguments": {
                    "alert_iri": "",
                    "indicator": "{{ vars.item }}",
                    "signal_id": "{{vars.steps.Get_Details.data.id}}",
                    "signal_name": "{{vars.steps.Get_Details.data.name}}",
                    "signal_description": "{{vars.steps.Get_Details.data.description}}"
                },
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/8d274bbe-0b78-4d0b-be0d-644a766566fa"
            },
            "status": null,
            "top": "30",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "c860ec38-7aea-4ede-b578-7441f232a8fb",
            "id": 295
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Details",
            "description": null,
            "arguments": {
                "name": "JASK ASOC",
                "config": "d12afb7a-4904-4375-b03c-efa283286a51",
                "params": {
                    "signalId": "{{ vars.input.params.signal.id }}"
                },
                "version": "1.0.0",
                "connector": "jask-asoc",
                "operation": "get_signal_details",
                "operationTitle": "Get Signal Details",
                "step_variables": {
                    "full_record": "{{ vars.result.data['full_records'][0] }}"
                }
            },
            "status": null,
            "top": "30",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "369a6d59-8a70-4d66-9039-2eafb15d5f27",
            "id": 296
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": {
                            "signal": "{{ vars.signal }}",
                            "alert_iri": "{{ vars.alert_iri }}"
                        }
                    },
                    "indicators": "[]"
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "980abe3f-5331-48a6-b691-16bfe6cd1451",
            "id": 297
        },
        {
            "@type": "WorkflowStep",
            "name": "Output Indicator IRIs",
            "description": null,
            "arguments": {
                "indicator_iris": "{{ vars.steps.Add_or_Find_Indicator_Records | json_query('[].indicator_iri') }}"
            },
            "status": null,
            "top": "30",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "249ab9c9-5e9b-4cc7-8e17-ed1dd19997eb",
            "id": 298
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get details -> Pull Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/56fb8c0f-8f3b-4505-807a-b48580841b88",
            "sourceStep": "\/api\/3\/workflow_steps\/369a6d59-8a70-4d66-9039-2eafb15d5f27",
            "label": null,
            "isExecuted": false,
            "uuid": "40c1c554-0f15-430c-9f41-e105832f1bfd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get details",
            "targetStep": "\/api\/3\/workflow_steps\/369a6d59-8a70-4d66-9039-2eafb15d5f27",
            "sourceStep": "\/api\/3\/workflow_steps\/980abe3f-5331-48a6-b691-16bfe6cd1451",
            "label": null,
            "isExecuted": false,
            "uuid": "88a5954f-cea9-45ad-b3b0-9c5dd4e63d5b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Threat Indicators to list -> Add or Find Indicator Records",
            "targetStep": "\/api\/3\/workflow_steps\/c860ec38-7aea-4ede-b578-7441f232a8fb",
            "sourceStep": "\/api\/3\/workflow_steps\/945f02cb-667d-4892-a746-1bbf57009e16",
            "label": null,
            "isExecuted": false,
            "uuid": "f96e53cf-56a4-429a-91ac-a1270b4faac0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add or Find Indicator Records -> Output Indicator IRIs",
            "targetStep": "\/api\/3\/workflow_steps\/249ab9c9-5e9b-4cc7-8e17-ed1dd19997eb",
            "sourceStep": "\/api\/3\/workflow_steps\/c860ec38-7aea-4ede-b578-7441f232a8fb",
            "label": null,
            "isExecuted": false,
            "uuid": "b6caa072-a344-4a67-9ccc-72193f00fef4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Pull Indicators from Signal Details -> Add Threat Indicators to list",
            "targetStep": "\/api\/3\/workflow_steps\/945f02cb-667d-4892-a746-1bbf57009e16",
            "sourceStep": "\/api\/3\/workflow_steps\/56fb8c0f-8f3b-4505-807a-b48580841b88",
            "label": null,
            "isExecuted": false,
            "uuid": "fef66677-e406-420a-a850-c368888ada3a"
        }
    ],
    "priority": null,
    "uuid": "92b328fd-8e7c-4fb1-a608-f47fec2f0c38",
    "recordTags": [
        "FSRSolutionPack",
        "vulnerabilityManagement-1.0.0",
        "Subroutine",
        "JASK",
        "JASK - Create Alert for Insight"
    ],
    "id": 74,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1638454902,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1638455616,
    "owners": [],
    "isPrivate": false
}