{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "JASK - Create or Find Indicator and Comment",
    "aliasName": null,
    "tag": "#JASK, #Signal, #Indicator",
    "description": "Creates or find an indicator and comments from insights",
    "isActive": false,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "indicator",
        "signal_id",
        "signal_name",
        "signal_description"
    ],
    "synchronous": false,
    "lastModifyDate": 1646219489,
    "collection": "\/api\/3\/workflow_collections\/817daef5-8d0e-4c2e-8cd7-7d5d8da9ceb4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/06214648-7ceb-4a5a-8473-fbe6e1bb115f",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create Indicator",
            "description": null,
            "arguments": {
                "resource": {
                    "tags": null,
                    "hunts": null,
                    "notes": null,
                    "value": "{{ vars.input.params.indicator.value }}",
                    "alerts": null,
                    "assets": null,
                    "emails": null,
                    "events": null,
                    "owners": null,
                    "persons": null,
                    "sources": null,
                    "comments": null,
                    "__replace": "true",
                    "campaigns": null,
                    "companies": null,
                    "evidences": null,
                    "incidents": null,
                    "reputation": null,
                    "attachments": null,
                    "description": null,
                    "indicatorStatus": null,
                    "typeofindicator": "{{ (\"IndicatorType\" | picklist(\"IP Address\"))[\"@id\"] if \" IP\" in vars.input.params.indicator.name else (\"IndicatorType\" | picklist(\"FileHash-MD5\"))[\"@id\"] if vars.input.params.indicator.name == \"MD5\" else (\"IndicatorType\" | picklist(\"FileHash-SHA256\"))[\"@id\"] if vars.input.params.indicator.name == \"SHA256\"  else (\"IndicatorType\" | picklist(\"Domain\"))[\"@id\"] if vars.input.params.indicator.name == \"hostname\" else (\"IndicatorType\" | picklist(\"URL\"))[\"@id\"] if vars.input.params.indicator.name == \"url\" else None}}",
                    "vulnerabilities": null,
                    "correlationGraph": null
                },
                "_showJson": false,
                "collection": "\/api\/3\/upsert\/indicators",
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "e62a4c18-0987-4855-8ac3-0401f973a25e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": {
                            "alert_iri": "{{ vars.alert_iri }}",
                            "indicator": "{{ vars.indicator }}",
                            "signal_id": "{{ vars.signal_id }}",
                            "signal_name": "{{ vars.signal_name }}",
                            "signal_description": "{{ vars.signal_description }}"
                        }
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "06214648-7ceb-4a5a-8473-fbe6e1bb115f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Output Record 2",
            "description": null,
            "arguments": {
                "indicator_iri": "{{vars.steps.Create_Indicator['@id']}}"
            },
            "status": null,
            "top": "30",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "02479167-e4db-4b71-8d54-b52a96d5c4cf"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Create Indicator -> Output Record 2",
            "targetStep": "\/api\/3\/workflow_steps\/02479167-e4db-4b71-8d54-b52a96d5c4cf",
            "sourceStep": "\/api\/3\/workflow_steps\/e62a4c18-0987-4855-8ac3-0401f973a25e",
            "label": null,
            "isExecuted": false,
            "uuid": "95b13972-1e07-41fd-9ffa-66f971e55f7e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Create Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/e62a4c18-0987-4855-8ac3-0401f973a25e",
            "sourceStep": "\/api\/3\/workflow_steps\/06214648-7ceb-4a5a-8473-fbe6e1bb115f",
            "label": null,
            "isExecuted": false,
            "uuid": "b366bdfc-c9e5-4441-b6d2-1679644a9680"
        }
    ],
    "priority": null,
    "uuid": "8d274bbe-0b78-4d0b-be0d-644a766566fa",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Subroutine",
        "FSRSolutionPack",
        "vulnerabilityManagement-1.0.1",
        "JASK",
        "JASK - Get Signal Details"
    ]
}