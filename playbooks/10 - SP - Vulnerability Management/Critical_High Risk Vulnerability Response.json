{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Critical\/High Risk Vulnerability Response",
    "aliasName": null,
    "tag": null,
    "description": "Creates a manual input step to take confirmation on resolution of all the vunerabilities for the asset",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/d99a8b59-a957-4d95-ac1c-da59ec91a117",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/a381e061-44c9-4974-a441-6f3ec3d63ea3",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertID": "{{vars.input.records[0].id}}",
                "alertIRI": "{{vars.input.records[0]['@id']}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "4c594e1e-9a24-49cd-b625-7f72bc1768f8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Manual Input",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Confirm Vulnerability Status",
                        "description": "### Asset Details\n**Asset IP**: {{vars.assetIP}}\n**Asset Hostname**: {{vars.assetHostname}}\n<br>\n<span style=\"font-size: 15px;\">Confirm that all the vulnerabilities mentioned in alert description for the asset has been resolved.<\/span>\n\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "All Vulnerability Resolved",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "6c240b3d-45e5-476b-a7a2-3a5f976cd391"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Correlated Asset",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "id",
                            "value": "{{vars.alertID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "assets"
                    ]
                },
                "module": "alerts?$limit=30&$relationships=true",
                "checkboxFields": true,
                "step_variables": {
                    "assetID": "{{vars.result[0].assets[0].id}}",
                    "assetIP": "{{vars.result[0].assets[0].ip}}",
                    "assetIRI": "{{vars.result[0].assets[0]['@id']}}",
                    "assetHostname": "{{vars.result[0].assets[0].hostname}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "7b3cdfe7-78d7-49d2-b55d-e1242bb38c05"
        },
        {
            "@type": "WorkflowStep",
            "name": "Delink Asset Vulnerabilities",
            "description": "Delink all the asset vulnerabilities",
            "arguments": {
                "resource": {
                    "vulnerabilities": "[]"
                },
                "operation": "Overwrite",
                "collection": "{{vars.assetIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/assets",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "7c09bd19-c688-4f5c-a586-c70f1ec83c53"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "type",
                            "value": "\/api\/3\/picklists\/6bf60659-76c2-48c4-9171-8c8c16f3b85e",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/6bf60659-76c2-48c4-9171-8c8c16f3b85e",
                                "itemValue": "Vulnerable Asset"
                            },
                            "operator": "eq"
                        }
                    ]
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "group": null,
            "uuid": "a381e061-44c9-4974-a441-6f3ec3d63ea3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "status": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232"
                },
                "operation": "Append",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": [],
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "ba3e3fa6-7331-4b01-b65c-eefba2fd6134"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Alert Status",
            "description": null,
            "arguments": {
                "resource": {
                    "status": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a"
                },
                "operation": "Append",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": [],
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "e723e291-00be-4996-b15b-570eca954679"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Update Alert Description -> Manual Input",
            "targetStep": "\/api\/3\/workflow_steps\/6c240b3d-45e5-476b-a7a2-3a5f976cd391",
            "sourceStep": "\/api\/3\/workflow_steps\/e723e291-00be-4996-b15b-570eca954679",
            "label": null,
            "isExecuted": false,
            "uuid": "32696e84-0fe1-440e-9273-34146626757c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Manual Input -> Delink Asset Vulnerabilities",
            "targetStep": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53",
            "sourceStep": "\/api\/3\/workflow_steps\/6c240b3d-45e5-476b-a7a2-3a5f976cd391",
            "label": "All Vulnerability Resolved",
            "isExecuted": false,
            "uuid": "4b56dca3-6dc1-4f69-bac4-deff89ff64df"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/4c594e1e-9a24-49cd-b625-7f72bc1768f8",
            "sourceStep": "\/api\/3\/workflow_steps\/a381e061-44c9-4974-a441-6f3ec3d63ea3",
            "label": null,
            "isExecuted": false,
            "uuid": "4c6be031-33cb-4bfa-b848-3523dd9ac645"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Correlated Asset -> Update Alert Description",
            "targetStep": "\/api\/3\/workflow_steps\/e723e291-00be-4996-b15b-570eca954679",
            "sourceStep": "\/api\/3\/workflow_steps\/7b3cdfe7-78d7-49d2-b55d-e1242bb38c05",
            "label": null,
            "isExecuted": false,
            "uuid": "4ff65af6-e432-4a05-9ccf-f5e61865ea74"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Correlated Asset",
            "targetStep": "\/api\/3\/workflow_steps\/7b3cdfe7-78d7-49d2-b55d-e1242bb38c05",
            "sourceStep": "\/api\/3\/workflow_steps\/4c594e1e-9a24-49cd-b625-7f72bc1768f8",
            "label": null,
            "isExecuted": false,
            "uuid": "b1748c9f-5278-4d71-b013-008b1f882ef1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Delink Asset Vulnerabilities -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/ba3e3fa6-7331-4b01-b65c-eefba2fd6134",
            "sourceStep": "\/api\/3\/workflow_steps\/7c09bd19-c688-4f5c-a586-c70f1ec83c53",
            "label": null,
            "isExecuted": false,
            "uuid": "f7f970b7-fe5d-46f5-bf80-b4419777b649"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "c95c7f52-32cb-4dd0-acd5-40917b79e9d5",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "PostCreate"
    ]
}